
```sql

CREATE DATABASE security DEFAULT CHARSET utf8 COLLATE utf8_general_ci;

```

## 1. åŸºæœ¬æ¦‚å¿µ

### 1.1. SQL åˆ†ç±»

```sql
DDL (Data Definition Language)  : createã€dropã€alter
DCL (Data Control Language)     : selectã€insertã€updateã€deleteã€
                                  executeã€referencesã€usage
DML (Data Manipulation Language) :  CRUD
TCL (Transaction Control Language) : commitã€rollback
```

## 2. æ•°æ®ç±»å‹

```puml
@startmindmap
* æ•°æ®ç±»å‹
** æ•°å€¼
*** æ•´å‹
**** <b>tinyint</b> -- 1
**** <b>smallint</b> -- 2
**** <b>mediumint</b> -- 3
**** <b>int</b> -- 4
**** <b>bigint</b> -- 8
*** æµ®ç‚¹å‹
**** <b>float</b> -- 4
**** <b>double</b> -- 8
*** å®šç‚¹å‹
**** <b>decimal</b> --å¯å˜
** å…¶å®ƒ
*** <b>enum</b> æšä¸¾ -- 8
*** <b>set</b> é›†åˆ -- 3
-- å­—ç¬¦
--- <b>char</b> -- 8
--- <b>varchar</b> -- 16
--- <b>blob </b>
--- <b>text  </b>
--- <b>binary </b>
--- <b>varbinary </b>
-- æ—¥æœŸ
--- <b>datatime</b> -- 8
--- <b>data</b> -- 3
--- <b>timestamp </b> -- 4
--- <b>time  </b> -- 3
--- <b>year </b> -- 1
--- <b>varbinary </b>

@endmindmap
```

### varcharæœ€å¤§é•¿åº¦è®¡ç®—

```sql
varcharé•¿åº¦ =ï¼ˆ æœ€å¤§é•¿åº¦ - nullæ ‡å¿—ä½ - é•¿åº¦æ ‡å¿—ä½ ï¼‰ / å­—ç¬¦é›†å•ä¸ªå­—ç¬¦

æœ€å¤§é•¿åº¦    : 65535
nullæ ‡å¿—ä½  : æ¯åˆ—1ä¸ªæ ‡è¯†ï¼Œå 1ä¸ªbitï¼ˆæ¯8ä¸ªbitä¸º1ä¸ªå­—èŠ‚ï¼Œä¸æ»¡ä¹Ÿä¸º1ä¸ªå­—èŠ‚ï¼‰
             å ç”¨å­—èŠ‚æ•° = ï¼ˆæ ‡å¿—ä½ /8ï¼‰
             å­˜æ”¾äºè¡Œæœ€å¼€å§‹çš„ä½ç½®ã€‚
é•¿åº¦æ ‡å¿—ä½  : é•¿åº¦ 0 - 255(2^8) 1ä¸ªå­—èŠ‚
            é•¿åº¦ 256 - 65535(2^16) 2ä¸ªå­—èŠ‚ï¼Œä¸”

```

>å­—ç¬¦é›†å•ä¸ªå­—ç¬¦æ‰€å å­—èŠ‚ ï¼š
latin1 : å•ä¸ªå­—ç¬¦å¯å 1ä¸ªå­—èŠ‚
GBK : å•ä¸ªå­—ç¬¦æœ€å¤§å¯å 2ä¸ªå­—èŠ‚
UTF8 ï¼šå•ä¸ªå­—ç¬¦æœ€å¤§å¯å 3ä¸ªå­—èŠ‚
UTF8MB4 ï¼šå•ä¸ªå­—ç¬¦æœ€å¤§å¯å 4ä¸ªå­—èŠ‚ (å¤§éƒ¨åˆ†ä¸­æ–‡å 3ä¸ªå­—èŠ‚)

![2020-06-20-21-43-42](./imgs/åŸºæœ¬ä½¿ç”¨.md/2020-06-20-21-43-42.png)

ğŸ”¹ æ¡ˆä¾‹ï¼š

```sql
create table test_varchar_length(
     v1 varchar(128) not null,
     v2 varchar(128) not null,
     vm varchar( n ) not null
) CHARSET=GBK;

nçš„å€¼æœ€å¤§ä¸ºå¤šå°‘ï¼Ÿ
```

![2020-06-20-22-24-04](./imgs/åŸºæœ¬ä½¿ç”¨.md/2020-06-20-22-24-04.png)

ç”±äºåˆ—vmå­—èŠ‚æ•° 65019 > 127 ï¼Œæ‰€ä»¥éœ€2ä¸ªå­—èŠ‚æ¥è®°å½•65019ï¼Œå³é•¿åº¦æ ‡å¿—ä¸º2ä¸ªå­—èŠ‚ã€‚ç”±äºå­—ç¬¦é›†ä¸ºGBKç¼–ç ï¼Œæ‰€ä»¥ n = (65019 -2) /2  = 32508.5ã€‚å‘ä¸‹å–æ•´ï¼Œå¾— n = 32508ã€‚

[ğŸ‘‰å‚è€ƒåšå®¢](https://learn.blog.csdn.net/article/details/103341778)

## 3. å­˜å‚¨è¿‡ç¨‹

```sql
==========================å®šä¹‰å­˜å‚¨è¿‡ç¨‹==========================
DELIMITER æ–°ç»“æŸç¬¦

CREATE PROCEDURE è¿‡ç¨‹å ( [[IN | OUT | INOUT] å‚æ•°å å‚æ•°ç±»å‹]  )
BEGIN

END
-- é‡æ–°è®¾ç½®ä¸º ; ç»“æŸç¬¦
DELIMITER ; 

============================è°ƒç”¨=================================
CALL æ•°æ®åº“åç§°.å­˜å‚¨è¿‡ç¨‹åç§° (å‚æ•°åˆ—è¡¨)

============================æŸ¥çœ‹=================================
SHOW PROCEDURE STATUS [LIKE åŒ¹é…æ¨¡å¼]\G
SHOW CREATE PROCEDURE è¿‡ç¨‹åç§°

====================ä¿®æ”¹ï¼ˆæ— æ³•ä¿®æ”¹å‚æ•°å’Œä¸»ä½“ï¼‰=======================
ALTER PROCEDURE å­˜å‚¨è¿‡ç¨‹åç§° [ç‰¹å¾]

===============================åˆ é™¤================================
DROP PROCEDURE [IF EXISTS] å­˜å‚¨è¿‡ç¨‹åç§°
```

## 4. SQLç¼–ç¨‹

```sql
===============================å‚æ•°=================================

1.ç³»ç»Ÿå˜é‡
SHOW VARIABLES [ LIKE 'åŒ¹é…æ¨¡å¼' | WHERE ]
-- å±€éƒ¨
SET å˜é‡å = å€¼
-- å…¨å±€
SET GLOABAL å˜é‡å = å€¼
--------------------------------------------
2.ç”¨æˆ·å˜é‡ï¼ˆä¼šè¯å˜é‡ï¼‰
--  æŸ¥çœ‹
SELECT @å˜é‡å.@å˜é‡å...
-- è®¾ç½®
SET @å˜é‡å = å€¼
SELECT ... INTO @å˜é‡å //å¯è®¾ç½®JSON
--------------------------------------------
3.å±€éƒ¨å˜é‡
DECLARE å˜é‡å1 [,å˜é‡å2...]  ç±»å‹  [ DEFALUT é»˜è®¤å€¼ ]

==============================é€»è¾‘è¯­å¥=================================
1.IFè¯­å¥
if search_condition then
    statement_list
[elseif search_condition then
    statement_list]
...
[else
    statement_list]
end if;

--------------------------------------------
2.CASEè¯­å¥
CASE value WHEN [compare-value] THEN result
[WHEN [compare-value] THEN result ...]
[ELSE result]
END

--------------------------------------------
3.LOOP ã€REPEATã€WHILE å¾ªç¯è¯­å¥

[æ ‡ç­¾å:] LOOP
    LEAVE æ ‡ç­¾å
END LOOP [æ ‡ç­¾å]

[æ ‡ç­¾å:] REPEAT
    è¯­å¥
UNTIL REPEAT [æ ‡ç­¾å]

[æ ‡ç­¾å:] while æ¡ä»¶ do
    LEAVE æ ‡ç­¾å
    iterate æ ‡ç­¾å
end while [æ ‡ç­¾å];

--------------------------------------------
4. è·³è½¬è¯­å¥
iterate æ ‡ç­¾å : è·³å‡ºå¾ªç¯
leave æ ‡ç­¾å   : è·³å‡ºå¾ªç¯ å’Œ  BEGIN..END
```

## 5. å‡½æ•°

[å‚è€ƒ--å‡½æ•°](https://www.yiibai.com/mysql/functions.html)

### 5.1 æ—¥æœŸå‡½æ•°

|å‡½æ•°åç§°|å«ä¹‰|è¡¥å……|
|-|-|-|
|now()|è·å–å½“å‰æ—¶é—´||
|year(time)|è·å–å¹´ä»½||
|month(time)|è·å–æœˆä»½||
|day(time)|è·å–æ—¥æœŸ||
|dayname(time)|è·å–æ˜ŸæœŸæ•°|
|timestampdiff(year\|month\|day,æ—¶é—´1,æ—¶é—´2)|è®¡ç®—ä¸¤ä¸ªæ—¶é—´çš„å·®å€¼|
